############ Add
OP=Add
LOWEROP=${OP,,}
NUM_BATCHES=1
OPSET=11
sog4onnx \
--op_type ${OP} \
--opset ${OPSET} \
--op_name ${LOWEROP}${OPSET} \
--input_variables whenet_a float32 [${NUM_BATCHES},3] \
--input_variables 6drepnet_b float32 [${NUM_BATCHES},3] \
--output_variables yaw_roll_pitch float32 [${NUM_BATCHES},3] \
--output_onnx_file_path ${OP}${OPSET}_merged_add.onnx


############ WHENet shrink
snc4onnx \
--input_onnx_file_paths whenet_1x3x224x224_prepost.onnx shrunk_whenet.onnx \
--srcop_destop yaw_roll_pitch shrunk_input \
--output_onnx_file_path whenet_prepost_disable_front_side_detection_1x3x224x224.onnx

onnxsim whenet_prepost_disable_front_side_detection_1x3x224x224.onnx whenet_prepost_disable_front_side_detection_1x3x224x224.onnx

############ 6DRepNet shrink
snc4onnx \
--input_onnx_file_paths sixdrepnet_300w_lp_maskplus_prepost_1x3x224x224.onnx shrunk_6drepnet.onnx \
--srcop_destop output_6drep_yaw_roll_pitch shrunk_input \
--output_onnx_file_path sixdrepnet_300w_lp_maskplus_prepost_disable_rear_side_detection_1x3x224x224.onnx

onnxsim sixdrepnet_300w_lp_maskplus_prepost_disable_rear_side_detection_1x3x224x224.onnx sixdrepnet_300w_lp_maskplus_prepost_disable_rear_side_detection_1x3x224x224.onnx




############ WHENet + 6DRepNet
snc4onnx \
--input_onnx_file_paths whenet_prepost_disable_front_side_detection_1x3x224x224.onnx sixdrepnet_300w_lp_maskplus_prepost_disable_rear_side_detection_1x3x224x224.onnx \
--srcop_destop input input \
--op_prefixes_after_merging whenet 6drepnet \
--output_onnx_file_path dmhead_merged.onnx

############ pinheadpose_merged + Add
snc4onnx \
--input_onnx_file_paths dmhead_merged.onnx Add11_merged_add.onnx \
--srcop_destop whenet_shrunk_output whenet_a 6drepnet_shrunk_output 6drepnet_b \
--output_onnx_file_path dmhead_1x3x224x224.onnx

onnxsim dmhead_1x3x224x224.onnx dmhead_1x3x224x224.onnx


